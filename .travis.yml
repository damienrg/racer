language: rust
rust:
  - stable

cache:
  apt: true

addons:
  apt:
    packages:
      - libcurl4-openssl-dev
      - libelf-dev
      - libdw-dev

after_success: |
  [ $TRAVIS_RUST_VERSION = stable ] &&
  wget https://github.com/SimonKagstrom/kcov/archive/master.tar.gz &&
  tar xzf master.tar.gz && mkdir kcov-master/build && cd kcov-master/build && cmake .. && make &&
  cd ../.. &&
  echo ${TRAVIS_JOB_ID} && ls target/debug &&
  ./kcov-master/build/src/kcov /tmp/kcov ./target/debug/system-*
